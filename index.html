<!doctype html>
<!--
Created using JS Bin
http://jsbin.com

Copyright (c) 2025 by nayeon9759 (http://jsbin.com/xotodom/3/edit)

Released under the MIT license: http://jsbin.mit-license.org
-->
<meta name="robots" content="noindex">
<html lang="ko">
<head>
 <meta charset="utf-8" />
 <meta name="viewport" content="width=device-width,initial-scale=1" />
 <title>반려친구 긴급케어 설문</title>
 <link rel="stylesheet" href="styles.css">
 <style id="jsbin-css">
/* 기존 디자인 그대로 유지 */
:root{
 --bg:#0f1724;
 --primary:#ff4d4f;
 --accent:#ff9f43;
 --card:#1f2a38;
 --muted:#b9c0d7;
  --text-main: #e6eef8; /* 명확한 메인 텍스트 색상 */
}

*{box-sizing:border-box}
/* body에 기본 배경과 텍스트 색상 강제 적용 */
body{
    margin:0; 
    font-family: "Noto Sans KR", sans-serif; 
    background:var(--bg); 
    color:var(--text-main); 
    padding:20px;
}
.wrap{max-width:900px;margin:0 auto;border-radius:12px;background:var(--card);padding:16px;box-shadow:0 6px 20px rgba(0,0,0,0.5);}

/* HERO */
.hero{padding:16px 20px;border-bottom:1px solid rgba(255,255,255,0.1)}
.hero-inner h1{margin:0;color:var(--primary)}
.lead{margin:4px 0 0;color:var(--muted);font-size:14px}

/* TABS */
.tabs{display:flex; gap:6px; margin:12px 0;}
.tab-btn{flex:1;padding:8px 10px;border-radius:8px;background:var(--card);border:1px solid rgba(255,255,255,0.1);color:var(--muted);cursor:pointer;transition:0.2s}
.tab-btn.active{background:var(--primary);color:white;box-shadow:0 4px 12px rgba(255,77,79,0.4);}

/* submissions */
.submissions-list{
 margin-top:12px;
 display:grid;
 gap:8px;
 max-height:300px; 
 overflow:auto; 
 padding-right:4px; 
}

/* PANELS */
.panel{display:none;padding:12px 0}
.panel.active{display:block}
.form-card{
    background:rgba(255,255,255,0.05);
    padding:12px;
    margin-bottom:24px; /* 이전 수정: 질문 박스 간격 넓힘 */
    border-radius:8px;
    border:1px solid rgba(255,255,255,0.1)
}
/* ⭐️ 질문 텍스트 아래 간격을 넓힘 (6px -> 12px) */
.q{font-weight:700;margin-bottom:12px} 
.required{color:var(--primary)}

.options.inline label{margin-right:16px}
.options.grid{display:grid;grid-template-columns:1fr 1fr;gap:6px}
.options label{display:flex;align-items:center;padding:8px;border-radius:6px;background:rgba(255,255,255,0.02);cursor:pointer;transition:0.2s}
.options input{margin-right:6px}

/* 입력 필드 색상 명확화 */
select,textarea,input[type="text"]{
    width:100%;
    padding:8px;
    border-radius:6px;
    background:rgba(255,255,255,0.03);
    border:1px solid rgba(255,255,255,0.1);
    color:var(--text-main); 
    font-size:14px;
}

/* Buttons */
.btn{padding:8px 12px;border-radius:6px;font-weight:700;cursor:pointer;border:none;transition:0.2s}
.btn.primary{background:var(--primary);color:white;box-shadow:0 4px 12px rgba(255,77,79,0.4);}
.btn.primary:hover{transform:scale(1.05)}
.btn.ghost{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.1);}
.btn.small{padding:4px 8px;font-size:12px}

/* submissions */
.record{background:rgba(255,255,255,0.02);padding:8px;border-radius:6px}

/* guide */
.guide-card{padding:10px;background:rgba(255,255,255,0.01);border-radius:6px;border:1px solid rgba(255,255,255,0.1)}

/* footer */
.footer{margin-top:12px;text-align:center;font-size:12px;color:var(--muted)}

/* YouTube 영상 섹션 */
.video-guide{
 margin-top: 20px;
 padding: 16px;
 background: rgba(255, 77, 79, 0.05); 
 border-radius: 8px;
 border: 1px solid var(--primary);
}
.guide-title{
 font-size: 16px;
 color: var(--primary);
 margin-top: 0;
 margin-bottom: 12px;
 font-weight: 700;
}
.video-container{
 position: relative;
 width: 100%;
 /* 유튜브 화면 크기 살짝 줄임 */
 padding-bottom: 50%;
 height: 0;
 overflow: hidden;
 border-radius: 6px;
}
.video-container iframe{
 position: absolute;
 top: 0;
 left: 0;
 width: 100%;
 height: 100%;
}
.video-caption{
 font-size: 13px;
 color: var(--muted);
 margin-top: 10px;
 text-align: center;
}

/* 기존 chart 관련 스타일 제거 */
.charts h4{
 font-size: 16px;
 color: var(--primary);
 margin-bottom: 12px;
}
.charts canvas{
 display: none;
}

@media(max-width:640px){.options.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
 <main class="wrap">
  <header class="hero">
   <div class="hero-inner">
    <h1>🐾 긴급! 24시 동물병원 설문</h1>
    <p class="lead">응급 상황—우리 서비스가 진짜 도움이 되도록, 솔직한 의견을 들려주세요.</p>
   </div>
  </header>

  <nav class="tabs">
   <button class="tab-btn active" data-target="survey">설문 참여</button>
   <button class="tab-btn" data-target="guide">설문 안내</button>
   <button class="tab-btn" data-target="submissions">다른 사람 의견 보기</button>
  </nav>

    <section id="survey" class="tab-panel active panel">
   <form id="petSurveyForm" class="survey-form" autocomplete="off">
        <div class="form-card">
     <label class="q">1. 반려동물을 키우시나요? <span class="required">*</span></label>
     <div class="options inline">
      <label><input type="radio" name="hasPet" value="예" required> 예</label>
      <label><input type="radio" name="hasPet" value="아니오"> 아니오</label>
     </div>
    </div>

        <div class="form-card">
     <label class="q">2. 당신이 사는 지역은 어디인가요?</label>
     <div class="options">
      <label><input type="radio" name="region" value="서울"> 서울</label>
      <label><input type="radio" name="region" value="경기도"> 경기도</label>
      <label><input type="radio" name="region" value="경상도"> 경상도</label>
      <label><input type="radio" name="region" value="기타"> 기타</label>
      <input type="text" name="regionOther" placeholder="직접 입력" style="display:none;">
     </div>
    </div>

        <div class="form-card">
     <label class="q">3. 평소 동물병원 선택 시 가장 우선시하는 기준은 무엇인가요? <span class="required">*</span></label>
     <select name="priorityCriteria" required>
      <option value="">선택하세요</option>
      <option value="비용">비용</option>
      <option value="직원의 친절도">직원의 친절도</option>
      <option value="거리">거리</option>
      <option value="병원의 평판">병원의 평판</option>
      <option value="의료진의 전문성 및 경험">의료진의 전문성 및 경험</option>
     </select>
    </div>

        <div class="form-card">
     <label class="q">4. 응급 상황에서 우려되는 점과, 필요한 서비스 기능은 무엇인가요?” <span class="required">*</span></label>
     <textarea name="concernAndFeature" rows="5" placeholder="예: 야간 응급비용이 불투명 → 가격 투명성 & 예상비용 계산 기능" required></textarea>
    </div>

        <div class="form-card">
     <label class="q">5. 응급 상황 시 병원 정보에서 '가장 중요한 정보(1순위)'와 '두 번째로 중요한 정보(2순위)'를 선택해주세요. <span class="required">*</span></label>
     <div class="priority-grid">
      <div>
       <label class="small">1순위</label>
       <select name="priority1" required>
        <option value="">선택</option>
        <option value="현재 운영 여부">A. 현재 운영 여부</option>
        <option value="주차 가능 여부">B. 주차 가능 여부</option>
        <option value="주요 진료 과목">C. 주요 진료 과목</option>
       </select>
      </div>
      <div>
       <label class="small">2순위</label>
       <select name="priority2" required>
        <option value="">선택</option>
        <option value="현재 운영 여부">A. 현재 운영 여부</option>
        <option value="주차 가능 여부">B. 주차 가능 여부</option>
        <option value="주요 진료 과목">C. 주요 진료 과목</option>
       </select>
      </div>
     </div>
    </div>

        <div class="form-card">
     <label class="q">6. 반려동물 응급 시 최대 지불 의향 금액 범위는? <span class="required">*</span></label>
     <div class="options grid">
      <label><input type="radio" name="priceRange" value="50만원 미만" required> A. 50만원 미만</label>
      <label><input type="radio" name="priceRange" value="50만원 ~ 100만원"> B. 50만원 ~ 100만원</label>
      <label><input type="radio" name="priceRange" value="100만원 ~ 200만원"> C. 100만원 ~ 200만원</label>
      <label><input type="radio" name="priceRange" value="200만원 이상"> D. 200만원 이상</label>
     </div>
    </div>

    <div class="form-actions">
     <button type="submit" class="btn primary">제출하기</button>
     <button type="reset" class="btn ghost">초기화</button>
    </div>

    <div id="msg" class="msg" aria-live="polite"></div>
   </form>
  </section>

    <section id="guide" class="tab-panel panel">
   <article class="guide-card">
    <h3>설문 안내 & 개인정보</h3>
    <p>이 설문은 반려동물 응급 대응 서비스 개선을 위한 조사입니다. 제출된 응답은 익명으로 기록됩니다.</p>
   </article>
  </section>

    <section id="submissions" class="tab-panel panel">
   <div class="panel-head">
    <h3>최근 제출된 의견</h3>
   </div>
   <div id="submissionsList" class="submissions-list">
    <div class="placeholder">아직 제출된 기록이 없습니다.</div>
   </div>

      <div class="video-guide">
    <h4 class="guide-title">🚨 응급 상황! 대처법 안내 (참고 영상)</h4>
    <div class="video-container">
          <iframe
      width="100%"
      height="315"
      src="https://www.youtube.com/embed/DYZyQ-DVkvU"
      title="반려동물 응급상황 대처방법"
      frameborder="0"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
      allowfullscreen>
     </iframe>
    </div>
    <p class="video-caption">
    긴급 상황 시 설문 응답을 기다릴 수 없는 분들을 위해, 믿을 수 있는 채널의 응급 대처 영상을 바로 제공합니다.
    </p>
   </div>
     </section>

  <footer class="footer">
   <small>© 반려친구 긴급케어 · 설문용 데모 페이지</small>
  </footer>
 </main>

 <script src="script.js"></script>
<script id="jsbin-javascript">
document.addEventListener("DOMContentLoaded", () => {
 // Google Apps Script URL (고객님 링크 유지)
 const API_URL = 'https://script.google.com/macros/s/AKfycbwfqm6JLNMXqL1MTumvEMuCp_IeBnddDMmIKocbQaMqOzXXayFz9DzdUWHnyt4LZEZ6AA/exec';

 const form = document.getElementById("petSurveyForm");
 const msg = document.getElementById("msg");
 const submissionsList = document.getElementById("submissionsList");
 const regionOtherInput = document.querySelector('input[name="regionOther"]');
 const tabBtns = document.querySelectorAll(".tab-btn");

 let localSubmissions = []; // 서버에서 불러온 전체 데이터

 // ⭐️ Chart.js 관련 변수 모두 제거됨

 const keyMap = {
  hasPet: "반려동물 보유",
  region: "지역",
  regionOther: "직접 입력 지역",
  priorityCriteria: "병원 선택 기준",
  concernAndFeature: "불만/필요 기능",
  priority1: "1순위 정보",
  priority2: "2순위 정보",
  priceRange: "최대 지불 의향"
 };

 /**
 * 1. 서버에서 최신 데이터를 가져와 localSubmissions를 갱신하고, 화면을 다시 그리는 핵심 함수
 */
 const fetchSubmissions = async () => {
  try {
   const uniqueApiUrl = `${API_URL}?t=${new Date().getTime()}`;
   submissionsList.innerHTML = '<div class="placeholder">제출된 기록을 불러오는 중입니다...</div>';

   const res = await fetch(uniqueApiUrl);
   if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
  
   const data = await res.json();
  
   if (Array.isArray(data)) {
    localSubmissions = data;
    renderSubmissions(); // 목록 갱신
    // ⭐️ renderCharts 호출 제거
   } else {
    submissionsList.innerHTML = '<div class="placeholder">데이터 로딩 실패: 서버 응답 형식이 올바르지 않습니다.</div>';
   }
  } catch (error) {
   console.error("서버 데이터 로딩 오류:", error);
   submissionsList.innerHTML = '<div class="placeholder">네트워크 오류 또는 서버 오류로 데이터를 불러올 수 없습니다.</div>';
  }
 };


 // 2. 폼 제출 (POST 후, 전체 데이터 재요청 로직 포함)
 form.addEventListener("submit", async (e) => {
  e.preventDefault();
  msg.textContent = "✅ 제출 중...";

  const data = new FormData(form);
  const payload = {};
  for (const [k, v] of data.entries()) payload[k] = v;

  try {
   await fetch(API_URL, {
    method: 'POST',
    mode: 'no-cors',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload)
   });

   msg.textContent = "💌 제출이 완료되었습니다! 의견 목록을 갱신합니다.";
  
   await fetchSubmissions();

   form.reset();
   regionOtherInput.style.display = "none";
  
   // '다른 사람 의견 보기' 탭으로 자동 전환 및 활성화
   document.querySelector('.tab-btn[data-target="submissions"]').click();

  } catch (error) {
   msg.textContent = "⚠️ 서버 응답 오류 발생. 데이터 갱신을 시도합니다.";
   await fetchSubmissions();
   document.querySelector('.tab-btn[data-target="submissions"]').click();
  }
 });

 // 3. submissions 렌더링
 const renderSubmissions = () => {
  submissionsList.innerHTML = "";
 
  if (localSubmissions.length === 0) {
    submissionsList.innerHTML = '<div class="placeholder">아직 제출된 기록이 없습니다.</div>';
    return;
  }
 
  localSubmissions.slice().reverse().forEach((sub) => {
   const card = document.createElement("div");
   card.className = "record";
   let html = Object.entries(sub)
    .filter(([k,v]) => !(k === "regionOther" && sub.region !== "기타") && v !== "")
    // ⭐️ 임시로 Reaction 등의 알 수 없는 키를 필터링합니다.
    .filter(([k, v]) => keyMap[k] !== undefined) 
    .map(([k,v]) => `<div><strong>${keyMap[k]||k}:</strong> ${v}</div>`)
    .join("");
   
   if (!html) html = "<div>제출된 정보 없음</div>";
   card.innerHTML = html;
   submissionsList.appendChild(card);
  });
 };

 // ⭐️ 4. renderCharts 함수 제거

 // 5. 탭 클릭 이벤트 (탭 전환 및 submissions 탭 클릭 시 서버 데이터 재요청)
 tabBtns.forEach(btn => {
  btn.addEventListener("click", () => {
   tabBtns.forEach(b => b.classList.remove("active"));
   document.querySelectorAll(".tab-panel").forEach(p => p.classList.remove("active"));
  
   btn.classList.add("active");
   document.getElementById(btn.dataset.target).classList.add("active");

   if (btn.dataset.target === "submissions") {
    fetchSubmissions(); // 탭 클릭 시에도 최신 데이터 강제 로드
   }
  });
 });

 // 6. 초기 서버 데이터 로드
 fetchSubmissions();

 // 7. "기타" 입력 토글 (기존 유지)
 document.querySelectorAll('input[name="region"]').forEach(radio => {
  radio.addEventListener('change', () => {
   if (radio.value === "기타") {
    regionOtherInput.style.display = "block";
    regionOtherInput.required = true;
   } else {
    regionOtherInput.style.display = "none";
    regionOtherInput.required = false;
   }
  });
 });
});
</script>
</body>
</html>