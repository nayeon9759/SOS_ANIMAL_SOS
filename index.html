<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°˜ë ¤ë™ë¬¼ ë³‘ì› ì´ìš© ì„¤ë¬¸ì¡°ì‚¬</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font (Tailwind default) -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f7fafc; }
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }
        /* ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ */
        .record {
            background-color: #ffffff;
            border-left: 4px solid #3b82f6; /* Blue border */
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(10px);
            animation: fadeIn 0.5s ease forwards;
        }
        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .record.fade-in {
            animation-delay: var(--delay);
        }
        .text-accent { color: #10b981; /* Emerald */ }
        .text-muted { color: #9ca3af; /* Gray */ }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#3b82f6', // Blue-500
                        'secondary': '#10b981', // Emerald-500
                    }
                }
            }
        }
    </script>
</head>
<body class="p-4 sm:p-8 min-h-screen bg-gray-50">

    <div class="max-w-3xl mx-auto bg-white shadow-xl rounded-2xl p-6 sm:p-10">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-extrabold text-gray-800 mb-2">ë°˜ë ¤ë™ë¬¼ ë³‘ì› ì´ìš© ê²½í—˜ ì„¤ë¬¸</h1>
            <p class="text-gray-500">ì†”ì§í•œ ì˜ê²¬ì„ í†µí•´ ë” ë‚˜ì€ ì§„ë£Œ ì •ë³´ í™˜ê²½ì„ ë§Œë“¤ì–´ê°‘ë‹ˆë‹¤.</p>
        </header>

        <!-- Tab Navigation -->
        <div class="flex border-b border-gray-200 mb-6">
            <button class="tab-btn active px-4 py-2 text-sm font-medium border-b-2 border-primary text-primary transition duration-150" data-target="survey">
                ì„¤ë¬¸ ì‘ì„±í•˜ê¸°
            </button>
            <button class="tab-btn px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 transition duration-150" data-target="submissions">
                ë‹¤ë¥¸ ì‚¬ëŒ ì˜ê²¬ ë³´ê¸°
            </button>
        </div>

        <!-- 1. Survey Panel -->
        <div id="survey" class="tab-panel active">
            <form id="petSurveyForm" class="space-y-6">
                <!-- Message Area -->
                <p id="msg" class="text-center text-sm font-medium min-h-6"></p>

                <!-- Q1. ë°˜ë ¤ë™ë¬¼ ë³´ìœ  (hasPet) -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm">
                    <label class="block text-lg font-semibold text-gray-700 mb-3">Q1. ë°˜ë ¤ë™ë¬¼ì„ í˜„ì¬ í‚¤ìš°ê³  ê³„ì‹­ë‹ˆê¹Œ?</label>
                    <div class="flex flex-wrap gap-4">
                        <label class="inline-flex items-center">
                            <input type="radio" name="hasPet" value="ì˜ˆ" class="form-radio h-4 w-4 text-primary transition duration-150 ease-in-out" required>
                            <span class="ml-2 text-gray-700">ì˜ˆ</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" name="hasPet" value="ì•„ë‹ˆì˜¤" class="form-radio h-4 w-4 text-primary transition duration-150 ease-in-out">
                            <span class="ml-2 text-gray-700">ì•„ë‹ˆì˜¤</span>
                        </label>
                    </div>
                </div>

                <!-- Q2. ê±°ì£¼ ì§€ì—­ (region, regionOther) -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm">
                    <label class="block text-lg font-semibold text-gray-700 mb-3">Q2. ì£¼ë¡œ ê±°ì£¼í•˜ì‹œëŠ” ì§€ì—­ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.</label>
                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="region" value="ì„œìš¸" class="form-radio h-4 w-4 text-primary" required>
                            <span class="ml-2 text-sm text-gray-700">ì„œìš¸</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="region" value="ê²½ê¸°/ì¸ì²œ" class="form-radio h-4 w-4 text-primary">
                            <span class="ml-2 text-sm text-gray-700">ê²½ê¸°/ì¸ì²œ</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="region" value="ë¶€ì‚°/ê²½ë‚¨" class="form-radio h-4 w-4 text-primary">
                            <span class="ml-2 text-sm text-gray-700">ë¶€ì‚°/ê²½ë‚¨</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="region" value="ëŒ€êµ¬/ê²½ë¶" class="form-radio h-4 w-4 text-primary">
                            <span class="ml-2 text-sm text-gray-700">ëŒ€êµ¬/ê²½ë¶</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="region" value="ê´‘ì£¼/ì „ë¼" class="form-radio h-4 w-4 text-primary">
                            <span class="ml-2 text-sm text-gray-700">ê´‘ì£¼/ì „ë¼</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="region" value="ëŒ€ì „/ì¶©ì²­" class="form-radio h-4 w-4 text-primary">
                            <span class="ml-2 text-sm text-gray-700">ëŒ€ì „/ì¶©ì²­</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="region" value="ê°•ì›/ì œì£¼" class="form-radio h-4 w-4 text-primary">
                            <span class="ml-2 text-sm text-gray-700">ê°•ì›/ì œì£¼</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="region" value="ê¸°íƒ€" class="form-radio h-4 w-4 text-primary">
                            <span class="ml-2 text-sm text-gray-700">ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)</span>
                        </label>
                    </div>
                    <input type="text" name="regionOther" placeholder="ì§ì ‘ ì…ë ¥" style="display:none;" class="mt-3 w-full border-gray-300 rounded-lg shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 text-sm">
                </div>

                <!-- Q3. ë³‘ì› ì„ íƒ ê¸°ì¤€ (priorityCriteria) -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm">
                    <label class="block text-lg font-semibold text-gray-700 mb-3">Q3. ë™ë¬¼ë³‘ì› ì„ íƒ ì‹œ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ê³ ë ¤í•˜ëŠ” ê¸°ì¤€ì€ ë¬´ì—‡ì…ë‹ˆê¹Œ? (ì¤‘ë³µ ì„ íƒ ê°€ëŠ¥)</label>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-secondary/10 transition">
                            <input type="checkbox" name="priorityCriteria" value="ì˜ë£Œì§„ì˜ ì „ë¬¸ì„± ë° ê²½í—˜" class="form-checkbox h-4 w-4 text-secondary rounded">
                            <span class="ml-2 text-sm text-gray-700">ì˜ë£Œì§„ì˜ ì „ë¬¸ì„± ë° ê²½í—˜</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-secondary/10 transition">
                            <input type="checkbox" name="priorityCriteria" value="ì§„ë£Œë¹„ì˜ íˆ¬ëª…ì„±ê³¼ í•©ë¦¬ì„±" class="form-checkbox h-4 w-4 text-secondary rounded">
                            <span class="ml-2 text-sm text-gray-700">ì§„ë£Œë¹„ì˜ íˆ¬ëª…ì„±ê³¼ í•©ë¦¬ì„±</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-secondary/10 transition">
                            <input type="checkbox" name="priorityCriteria" value="ë³‘ì› ì‹œì„¤ ë° ì¥ë¹„ì˜ ìˆ˜ì¤€" class="form-checkbox h-4 w-4 text-secondary rounded">
                            <span class="ml-2 text-sm text-gray-700">ë³‘ì› ì‹œì„¤ ë° ì¥ë¹„ì˜ ìˆ˜ì¤€</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-secondary/10 transition">
                            <input type="checkbox" name="priorityCriteria" value="ë³‘ì› ì ‘ê·¼ì„± ë° ìœ„ì¹˜" class="form-checkbox h-4 w-4 text-secondary rounded">
                            <span class="ml-2 text-sm text-gray-700">ë³‘ì› ì ‘ê·¼ì„± ë° ìœ„ì¹˜</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-secondary/10 transition">
                            <input type="checkbox" name="priorityCriteria" value="ì¹œì ˆë„ ë° ì„œë¹„ìŠ¤" class="form-checkbox h-4 w-4 text-secondary rounded">
                            <span class="ml-2 text-sm text-gray-700">ì¹œì ˆë„ ë° ì„œë¹„ìŠ¤</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-secondary/10 transition">
                            <input type="checkbox" name="priorityCriteria" value="ì§„ë£Œ ì‹œê°„/ì˜ˆì•½ ì‹œìŠ¤í…œ í¸ë¦¬ì„±" class="form-checkbox h-4 w-4 text-secondary rounded">
                            <span class="ml-2 text-sm text-gray-700">ì§„ë£Œ ì‹œê°„/ì˜ˆì•½ ì‹œìŠ¤í…œ í¸ë¦¬ì„±</span>
                        </label>
                    </div>
                </div>

                <!-- Q4. ìš°ë ¤/í•„ìš” ê¸°ëŠ¥ (concernAndFeature) -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm">
                    <label for="concernAndFeature" class="block text-lg font-semibold text-gray-700 mb-3">Q4. í˜„ì¬ ë™ë¬¼ë³‘ì›ì„ ì´ìš©í•˜ë©´ì„œ ëŠë¼ëŠ” ê°€ì¥ í° ìš°ë ¤ì‚¬í•­ ë˜ëŠ” í•„ìš”í•˜ë‹¤ê³  ëŠë¼ëŠ” ê¸°ëŠ¥ì´ ìˆë‹¤ë©´ ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”.</label>
                    <textarea id="concernAndFeature" name="concernAndFeature" rows="3" class="w-full border-gray-300 rounded-lg shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 text-sm p-2" placeholder="ììœ ë¡­ê²Œ ì˜ê²¬ì„ ì‘ì„±í•´ ì£¼ì„¸ìš”."></textarea>
                </div>

                <!-- Q5. ì¤‘ìš” ì •ë³´ 1, 2ìˆœìœ„ (priority1, priority2) -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm space-y-4">
                    <h2 class="block text-lg font-semibold text-gray-700">Q5. ë™ë¬¼ë³‘ì›ì´ ì œê³µí•˜ëŠ” ì •ë³´ ì¤‘ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” 1, 2ìˆœìœ„ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?</h2>
                    
                    <div>
                        <label for="priority1" class="block text-base font-medium text-gray-700 mb-1">1ìˆœìœ„ ì •ë³´</label>
                        <select id="priority1" name="priority1" class="w-full border-gray-300 rounded-lg shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 text-sm p-2" required>
                            <option value="" disabled selected>ì„ íƒ</option>
                            <option value="í›„ê¸°/í‰ì ">í›„ê¸°/í‰ì </option>
                            <option value="ìƒì„¸ ì§„ë£Œ ë‚´ìš©">ìƒì„¸ ì§„ë£Œ ë‚´ìš©</option>
                            <option value="ì˜ë£Œì§„ ê²½ë ¥">ì˜ë£Œì§„ ê²½ë ¥</option>
                            <option value="ì¥ë¹„/ì‹œì„¤ ì •ë³´">ì¥ë¹„/ì‹œì„¤ ì •ë³´</option>
                            <option value="ì§„ë£Œë¹„ ì •ë³´">ì§„ë£Œë¹„ ì •ë³´</option>
                            <option value="ì§„ë£Œ ê°€ëŠ¥ ì‹œê°„">ì§„ë£Œ ê°€ëŠ¥ ì‹œê°„</option>
                            <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                        </select>
                    </div>

                    <div>
                        <label for="priority2" class="block text-base font-medium text-gray-700 mb-1">2ìˆœìœ„ ì •ë³´</label>
                        <select id="priority2" name="priority2" class="w-full border-gray-300 rounded-lg shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 text-sm p-2" required>
                            <option value="" disabled selected>ì„ íƒ</option>
                            <option value="í›„ê¸°/í‰ì ">í›„ê¸°/í‰ì </option>
                            <option value="ìƒì„¸ ì§„ë£Œ ë‚´ìš©">ìƒì„¸ ì§„ë£Œ ë‚´ìš©</option>
                            <option value="ì˜ë£Œì§„ ê²½ë ¥">ì˜ë£Œì§„ ê²½ë ¥</option>
                            <option value="ì¥ë¹„/ì‹œì„¤ ì •ë³´">ì¥ë¹„/ì‹œì„¤ ì •ë³´</option>
                            <option value="ì§„ë£Œë¹„ ì •ë³´">ì§„ë£Œë¹„ ì •ë³´</option>
                            <option value="ì§„ë£Œ ê°€ëŠ¥ ì‹œê°„">ì§„ë£Œ ê°€ëŠ¥ ì‹œê°„</option>
                            <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                        </select>
                    </div>
                </div>

                <!-- Q6. ì§€ë¶ˆ ì˜í–¥ ê¸ˆì•¡ (priceRange) -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm">
                    <label class="block text-lg font-semibold text-gray-700 mb-3">Q6. ì¤‘ëŒ€ ì§„ë£Œ ì‹œ, ì§„ë£Œ ì •ë³´ í”Œë«í¼ì— ì–´ëŠ ì •ë„ì˜ ê¸ˆì•¡ì„ ì§€ë¶ˆí•  ì˜í–¥ì´ ìˆìŠµë‹ˆê¹Œ?</label>
                    <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="priceRange" value="~1ë§Œì›" class="form-radio h-4 w-4 text-primary" required>
                            <span class="ml-2 text-sm text-gray-700">~1ë§Œì›</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="priceRange" value="1ë§Œì›~3ë§Œì›" class="form-radio h-4 w-4 text-primary">
                            <span class="ml-2 text-sm text-gray-700">1ë§Œì›~3ë§Œì›</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="priceRange" value="3ë§Œì›~5ë§Œì›" class="form-radio h-4 w-4 text-primary">
                            <span class="ml-2 text-sm text-gray-700">3ë§Œì›~5ë§Œì›</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="priceRange" value="5ë§Œì› ì´ìƒ" class="form-radio h-4 w-4 text-primary">
                            <span class="ml-2 text-sm text-gray-700">5ë§Œì› ì´ìƒ</span>
                        </label>
                        <label class="inline-flex items-center bg-white p-2 rounded-lg shadow-sm cursor-pointer hover:bg-primary/10 transition">
                            <input type="radio" name="priceRange" value="ì§€ë¶ˆ ì˜í–¥ ì—†ìŒ" class="form-radio h-4 w-4 text-primary">
                            <span class="ml-2 text-sm text-gray-700">ì§€ë¶ˆ ì˜í–¥ ì—†ìŒ</span>
                        </label>
                    </div>
                </div>

                <button type="submit" class="w-full py-3 bg-primary text-white font-bold rounded-lg shadow-md hover:bg-blue-600 transition duration-300 ease-in-out">
                    ì œì¶œí•˜ê¸°
                </button>
            </form>
        </div>

        <!-- 2. Submissions Panel -->
        <div id="submissions" class="tab-panel">
            <h2 class="text-xl font-bold text-gray-700 mb-4">ë‹¤ë¥¸ ì‚¬ëŒë“¤ì˜ ì˜ê²¬ (ìµœì‹  10ê°œ)</h2>
            <div id="submissionsList" class="space-y-4">
                <div class="placeholder text-center text-gray-500 p-4 border rounded-lg">íƒ­ì„ í´ë¦­í•˜ë©´ ìµœì‹  ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.</div>
            </div>
        </div>
    </div>

    <!-- The original JavaScript code is embedded here -->
    <script>
// === ìˆ˜ì •ëœ JavaScript ì½”ë“œ (ì¤‘ë³µ ì œì¶œ ë°©ì§€ ë° URL ì—…ë°ì´íŠ¸ ë²„ì „) ===
document.addEventListener("DOMContentLoaded", () => {
Â  // Google Apps Script URL (ê³ ê°ë‹˜ê»˜ì„œ ìš”ì²­í•˜ì‹  ë§í¬ë¡œ ìµœì¢… ì—…ë°ì´íŠ¸)
Â  const API_URL = 'https://script.google.com/macros/s/AKfycbwfqm6JLNMXqL1MTumvEMuCp_IeBnddDMmIKocbQaMqOzXXayFz9DzdUWHnyt4LZEZ6AA/exec';
Â Â 
Â  const form = document.getElementById("petSurveyForm");
Â  const msg = document.getElementById("msg");
Â  const submissionsList = document.getElementById("submissionsList");
Â  const regionOtherInput = document.querySelector('input[name="regionOther"]');
Â  const tabBtns = document.querySelectorAll(".tab-btn");

Â  let localSubmissions = []; // ì„œë²„ì—ì„œ ë¶ˆëŸ¬ì˜¨ ì „ì²´ ë°ì´í„°
Â  let isSubmitting = false; // ğŸ’¡ ì œì¶œ ì ê¸ˆ í”Œë˜ê·¸ ì¶”ê°€

Â  // â­ï¸ 1. ì‹œíŠ¸ ì»¬ëŸ¼ ì´ë¦„ê³¼ ì¶œë ¥ ë¼ë²¨ ì •ì˜ â­ï¸
Â  const keyMap = {
Â  Â  hasPet: "ë°˜ë ¤ë™ë¬¼ ë³´ìœ ",
Â  Â  region: "ì§€ì—­",
Â  Â  regionOther: "ì§ì ‘ ì…ë ¥ ì§€ì—­",
Â  Â  priorityCriteria: "ë³‘ì› ì„ íƒ ê¸°ì¤€ (Q3)",
Â  Â  concernAndFeature: "ìš°ë ¤/í•„ìš” ê¸°ëŠ¥ (Q4)",
Â  Â  priceRange: "ì§€ë¶ˆ ì˜í–¥ ê¸ˆì•¡ (Q6)",
Â  Â  priority1: "1ìˆœìœ„ ì •ë³´",
Â  Â  priority2: "2ìˆœìœ„ ì •ë³´",
Â  };

Â  // â­ï¸ 2. í‘œì‹œí•  í•µì‹¬ í•­ëª©ì„ ì˜¬ë°”ë¥¸ í‚¤ë¡œ ì •ì˜ â­ï¸
Â  const displayKeys = ["priorityCriteria", "priceRange", "concernAndFeature"];

Â  /**
Â  Â * ì„œë²„ì—ì„œ ìµœì‹  ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ localSubmissionsë¥¼ ê°±ì‹ í•˜ê³ , í™”ë©´ì„ ë‹¤ì‹œ ê·¸ë¦¬ëŠ” í•¨ìˆ˜
Â  Â */
Â  const fetchSubmissions = async () => {
Â  Â  try {
Â  Â  Â  const uniqueApiUrl = `${API_URL}?t=${new Date().getTime()}`;
Â  Â  Â  submissionsList.innerHTML = '<div class="placeholder">ì œì¶œëœ ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>';

Â  Â  Â  const res = await fetch(uniqueApiUrl);
Â  Â  Â  if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);

Â  Â  Â  const data = await res.json();

Â  Â  Â  if (Array.isArray(data)) {
Â  Â  Â  Â  localSubmissions = data;
Â  Â  Â  Â  renderSubmissions(); // ëª©ë¡ ê°±ì‹ 
Â  Â  Â  } else {
Â  Â  Â  Â  submissionsList.innerHTML = '<div class="placeholder">ë°ì´í„° ë¡œë”© ì‹¤íŒ¨: ì„œë²„ ì‘ë‹µ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>';
Â  Â  Â  }
Â  Â  } catch (error) {
Â  Â  Â  console.error("ì„œë²„ ë°ì´í„° ë¡œë”© ì˜¤ë¥˜:", error);
Â  Â  Â  submissionsList.innerHTML = '<div class="placeholder">ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë˜ëŠ” ì„œë²„ ì˜¤ë¥˜ë¡œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
Â  Â  }
Â  };

Â  // 2. í¼ ì œì¶œ (POST í›„, ì „ì²´ ë°ì´í„° ì¬ìš”ì²­ ë¡œì§ í¬í•¨) - ì¤‘ë³µ ì œì¶œ ë°©ì§€ ìˆ˜ì •
Â  form.addEventListener("submit", async (e) => {
Â  Â  e.preventDefault();

Â  Â  const submitBtn = form.querySelector('button[type="submit"]'); // ë²„íŠ¼ ì°¾ê¸°

Â  Â  if (isSubmitting) { // ğŸ’¡ ì¤‘ë³µ ì œì¶œ ë°©ì§€ ì²´í¬
Â  Â  Â  msg.textContent = "âš ï¸ ì´ë¯¸ ì œì¶œ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”.";
Â  Â  Â  return;
Â  Â  }

Â  Â  // ğŸ’¡ ì œì¶œ ì‹œì‘ ì‹œ ì ê¸ˆ ë° ë²„íŠ¼ ë¹„í™œì„±í™”
Â  Â  isSubmitting = true;
Â  Â  submitBtn.disabled = true;
Â  Â  submitBtn.textContent = "ì œì¶œ ì¤‘...";
Â  Â  msg.textContent = "âœ… ì œì¶œ ì¤‘...";

Â  Â  const data = new FormData(form);
Â  Â  const payload = {};
    
    // FormDataë¥¼ JSON payloadë¡œ ë³€í™˜ (ì²´í¬ë°•ìŠ¤ ê°’ ì²˜ë¦¬ í¬í•¨)
    const formKeys = ['hasPet', 'region', 'regionOther', 'concernAndFeature', 'priority1', 'priority2', 'priceRange'];
    
    // ì¼ë°˜ í‚¤ ì²˜ë¦¬
    for (const k of formKeys) {
        if (data.has(k)) {
            payload[k] = data.get(k);
        }
    }

    // ì²´í¬ë°•ìŠ¤ (priorityCriteria) ì²˜ë¦¬: ì—¬ëŸ¬ ê°’ì„ ì‰¼í‘œë¡œ ì—°ê²°
    const criteriaValues = data.getAll('priorityCriteria');
    if (criteriaValues.length > 0) {
        payload['priorityCriteria'] = criteriaValues.join(', ');
    } else {
        // GASì— ë³´ë‚¼ ë•Œ í•„ë“œê°€ ëˆ„ë½ë˜ì§€ ì•Šë„ë¡ ë¹ˆ ë¬¸ìì—´ë¡œ ë³´ëƒ„ (ì²´í¬ëœ í•­ëª©ì´ ì—†ëŠ” ê²½ìš°)
        payload['priorityCriteria'] = ''; 
    }

Â  Â  try {
Â  Â  Â  const response = await fetch(API_URL, {
Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  body: JSON.stringify(payload)
Â  Â  Â  });

Â  Â  Â  if (response.ok) {
Â  Â  Â  Â  const result = await response.json();
Â  Â  Â  Â  if (result.status === 'success') {
Â  Â  Â  Â  Â  msg.textContent = "ğŸ’Œ ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ì˜ê²¬ ëª©ë¡ì„ ê°±ì‹ í•©ë‹ˆë‹¤.";
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  await fetchSubmissions();
Â  Â  Â  Â  Â  form.reset();
Â  Â  Â  Â  Â  regionOtherInput.style.display = "none";
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // 'ë‹¤ë¥¸ ì‚¬ëŒ ì˜ê²¬ ë³´ê¸°' íƒ­ìœ¼ë¡œ ìë™ ì „í™˜ ë° í™œì„±í™”
Â  Â  Â  Â  Â  document.querySelector('.tab-btn[data-target="submissions"]').click();
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  throw new Error(result.message || 'ì„œë²„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
Â  Â  Â  Â  }
Â  Â  Â  } else {
Â  Â  Â  Â  throw new Error(`HTTP ì˜¤ë¥˜: ${response.status}`);
Â  Â  Â  }

Â  Â  } catch (error) {
Â  Â  Â  console.error('ì œì¶œ ì˜¤ë¥˜:', error);
Â  Â  Â  msg.textContent = `âš ï¸ ì œì¶œ ì‹¤íŒ¨: ${error.message}`;
Â  Â  Â Â 
Â  Â  } finally {
Â  Â  Â  // ğŸ’¡ ì„±ê³µ/ì‹¤íŒ¨ì™€ ê´€ê³„ì—†ì´ ì ê¸ˆ í•´ì œ ë° ë²„íŠ¼ í™œì„±í™”
Â  Â  Â  isSubmitting = false;
Â  Â  Â  submitBtn.disabled = false;
Â  Â  Â  submitBtn.textContent = "ì œì¶œí•˜ê¸°";
Â  Â  }
Â  });

Â  // 3. submissions ë Œë”ë§ (displayKeys ì ìš©)
Â  const renderSubmissions = () => {
Â  Â  submissionsList.innerHTML = "";

Â  Â  if (localSubmissions.length === 0) {
Â  Â  Â  submissionsList.innerHTML = '<div class="placeholder">ì•„ì§ ì œì¶œëœ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
Â  Â  Â  return;
Â  Â  }

Â  Â  // ìµœì‹  10ê°œë§Œ í‘œì‹œ
Â  Â  localSubmissions.slice().reverse().slice(0, 10).forEach((sub, index) => {
Â  Â  Â  const card = document.createElement("div");
Â  Â  Â  card.className = "record fade-in";
Â  Â  Â  card.style.setProperty('--delay', `${index * 0.05}s`);

Â  Â  Â  let html = displayKeys
Â  Â  Â  Â  .map(k => {
Â  Â  Â  Â  Â  const label = keyMap[k];
Â  Â  Â  Â  Â  let value = sub[k];
Â  Â  Â  Â  Â  const displayValue = (value && value !== "" && value !== " ") ? value : "ì‘ë‹µ ì—†ìŒ";
Â  Â  Â  Â  Â  return `<div class="record-item p-2">
Â  Â  Â  Â  Â  Â  <strong>${label}:</strong>
Â  Â  Â  Â  Â  Â  <span class="${displayValue === 'ì‘ë‹µ ì—†ìŒ' ? 'text-muted' : 'text-accent'}">${displayValue}</span>
Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  })
Â  Â  Â  Â  .join("");

Â  Â  Â  if (!html) html = "<div>ì œì¶œëœ ì •ë³´ ì—†ìŒ</div>";
Â  Â  Â  card.innerHTML = html;
Â  Â  Â  submissionsList.appendChild(card);
Â  Â  });
Â  };

Â  // 4. íƒ­ í´ë¦­ ì´ë²¤íŠ¸
Â  tabBtns.forEach(btn => {
Â  Â  btn.addEventListener("click", () => {
Â  Â  Â  tabBtns.forEach(b => b.classList.remove("active", "border-primary", "text-primary"));
Â  Â  Â  tabBtns.forEach(b => b.classList.add("border-transparent", "text-gray-500"));
Â  Â  Â  document.querySelectorAll(".tab-panel").forEach(p => p.classList.remove("active"));

Â  Â  Â  btn.classList.add("active", "border-primary", "text-primary");
Â  Â  Â  btn.classList.remove("border-transparent", "text-gray-500");
Â  Â  Â  document.getElementById(btn.dataset.target).classList.add("active");

Â  Â  Â  if (btn.dataset.target === "submissions") {
Â  Â  Â  Â  fetchSubmissions();
Â  Â  Â  }
Â  Â  });
Â  });

Â  // 5. "ê¸°íƒ€" ì…ë ¥ í† ê¸€
Â  document.querySelectorAll('input[name="region"]').forEach(radio => {
Â  Â  radio.addEventListener('change', () => {
Â  Â  Â  if (radio.value === "ê¸°íƒ€") {
Â  Â  Â  Â  regionOtherInput.style.display = "block";
Â  Â  Â  Â  regionOtherInput.required = true;
Â  Â  Â  } else {
Â  Â  Â  Â  regionOtherInput.style.display = "none";
Â  Â  Â  Â  regionOtherInput.required = false;
Â  Â  Â  }
Â  Â  });
Â  });
});
    </script>
</body>
</html>
